from rest_framework import serializers

from apps.exploits.models import EPSS, Exploit
from osidb.models import Affect, PsModule


class ExploitsSimpleSerializer(serializers.ModelSerializer):
    class Meta:
        model = Exploit
        fields = ["date", "source", "reference"]


class AffectExploitReportSerializer(serializers.ModelSerializer):
    cve = serializers.CharField(source="flaw.cve_id")
    product = serializers.CharField(source="ps_module")
    component = serializers.CharField(source="ps_component")
    resolution = serializers.CharField(source="resolution_expanded")

    class Meta:
        model = Affect
        fields = ["cve", "product", "component", "affectedness", "resolution"]


class EPSSSerializer(serializers.ModelSerializer):
    class Meta:
        model = EPSS
        fields = ["cve", "epss"]


class SupportedProductsSerializer(serializers.ModelSerializer):
    class Meta:
        model = PsModule
        fields = ["name"]
